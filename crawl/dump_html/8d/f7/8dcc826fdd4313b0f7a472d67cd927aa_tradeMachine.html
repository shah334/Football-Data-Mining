<!DOCTYPE html>
<html xmlns:fb="http://www.facebook.com/2008/fbml">
<head><script src="http://cdn.espn.com/sports/optimizely.js"></script><meta charset="iso-8859-1">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<link rel="icon" sizes="any" mask href="http://a.espncdn.com/favicon.ico">
<meta name="theme-color" content="#CC0000">
<script type="text/javascript">
    if(true && navigator && navigator.userAgent.toLowerCase().indexOf("teamstream") >= 0) {
        window.location = 'http://m.espn.com/mobilecache/general/apps/sc';
    }
</script><title>NBA Trade Machine - ESPN</title>
<meta name="google-site-verification" content="xuj1ODRluWa0frM-BjIr_aSHoUC7HB5C1MgmYAM_GkA" />
<meta name="msvalidate.01" content="B1FEB7C682C46C8FCDA3130F3D18AC28" />
<meta name="googlebot" content="noodp" />
<meta name="robots" content="index, follow" />
<meta name="description" content="NBA trade machine, make player trades" />
<meta name="keywords" content="nba trades, basketball trades, trade machine" />
<meta property="fb:app_id" content="116656161708917">
<meta property="og:site_name" content="ESPN.com">
<!--
<PageMap>
	<DataObject type="document">
		<Attribute name="title">NBA Trade Machine</Attribute>
	</DataObject>
	<DataObject type="thumbnail">
		<Attribute name="src" value="http://a4.espncdn.com/combiner/i?img=/i/espn/misc_logos/500/nba.png" />
		<Attribute name="width" value="500" />
		<Attribute name="height" value="500" />
	</DataObject>
</PageMap>
--><link rel="canonical" href="http://www.espn.com/nba/tradeMachine" />

		<script>var _sf_startpt=(new Date()).getTime();</script>
<link rel="search" type="application/opensearchdescription+xml" href="http://a.espncdn.com/search/opensearch.xml" title="ESPN Search" />
<link rel="stylesheet" href="http://a.espncdn.com/combiner/c/201501211964?css=global_reset.r1.css,base.r236.css,modules.r465_2.css,global_header.r44.css,header_topbar.r1.css,modules/global_nav.r54.css,modules/insider_enhanced.r1.css,modules/mem/mem.r12.1.css,modules/mem/mem_espn360.r8.4.css,modules/mem/skirmish.r8.css,modules/twin.r1.css,modules/facebook/button.r2.css,universal_overlay/universal_overlay.css,universal_overlay/media_overlay.css,universal_overlay/video_overlay.css,universal_overlay/photo_overlay.css,universal_overlay/dyk_overlay.css,fonts/bentonsans.css,fonts/bentonsansmedium.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://a.espncdn.com/combiner/c/201508060924?css=sprites/teamlogos.r19.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://a.espncdn.com/prod/styles/video/2.14.1-5/espn-web-player-bundle.css" />
<script src="http://widgets.outbrain.com/outbrain.js"></script>
<script type="text/javascript">
var _vrq = _vrq || [];
 _vrq.push(['id', 489]);
 _vrq.push(['automate', false]);
 _vrq.push(['track', function(){}]);
 (function(d, a){var s = d.createElement(a),x = d.getElementsByTagName(a)[0];
s.async = true;
s.src = 'http://a.visualrevenue.com/vrs.js';
 x.parentNode.insertBefore(s, x);})(document, 'script'); </script>
<script type="text/javascript" src="http://a.espncdn.com/legacy/desktop/1.0.45/js/espn-critical.js"></script>
<script type="text/javascript">
window.s_account = "wdgespcom";
if( typeof s_omni === "undefined" && typeof window.setReportSuite === "function") {
window.s_account = window.setReportSuite( "wdgespcom" );
}
</script>
<script src="http://a.espncdn.com/combiner/c?js=plugins/jquery.onavailable.js"></script>
<script>espn.core.navVersion = 'a';</script>
<script>var ad_site="espn.us.com.nba",ad_zone="nbatrademachine",ad_kvps="pgtyp=nbatrademachine;sp=nba;nav=true;",ad_swid="",ad_counter=1,ad_ord=Math.floor(9999999999*Math.random()),ad_seg="",ad_mnr=-1<document.cookie.indexOf("grif=1")?"t":"f",ad_ref="other",ad_sp="nba",ad_pgtyp="nbatrademachine",ad_pgn="",ref=document.referrer,refsMap={"facebook.com":"facebook","twitter.com|t.co":"twitter","plus.url.google.com|plus.google.com":"googleplus","google.com":"google","bing.com":"bing","yahoo.com":"yahoo","espn.com":"espn"},refKey;for(refKey in refsMap)ref.match(refKey)&&(ad_ref=refsMap[refKey]);
ad_kvps=ad_kvps+"ref="+ad_ref+";mnr="+ad_mnr+";";ad_swid=jQuery.cookie("SWID");"function"===typeof espn.core.ad_segments&&(ad_seg=espn.core.ad_segments(),null!=ad_seg&&""!=ad_seg&&(ad_kvps+=ad_seg));var ad_u="";null!=ad_swid&&""!=ad_swid&&(ad_u="swid="+ad_swid+";");</script>
<link rel="stylesheet" href="http://a.espncdn.com/legacy/transitionalHeader/1.0.54/css/transitional-header.css" type="text/css" media="screen" charset="utf-8" />
</head>
<body class="nba"  data-sport="nba" data-pagetype="nbatrademachine">
<!--[if IE 5]><div class="ie5"><![endif]-->
<!--[if IE 6]><div class="ie ie6"><![endif]-->
<!--[if IE 7]><div class="ie ie7"><![endif]-->
<!--[if IE 8]><div class="ie ie8"><![endif]-->
<!--[if IE 9]><div class="ie9"><![endif]-->
<!-- begin bg-elements -->
<div class="bg-elements">

<!-- gpt ad type: background_skin -->
<div class="ad-slot ad-slot-background_skin" data-slot-type="background_skin" data-slot-kvps="pos=background_skin" data-exclude-bp="s,m" data-collapse-before-load="true"></div><!-- begin subheader -->
<div id="subheader">
<!-- begin content -->
<div id="content-wrapper">
<div id="ad-top" class="container">
<!-- begin Banner ad -->
<div class="span-6 ad banner top"><div class="ad-center"><div class="ad-wrapper">
<!-- gpt ad type: banner -->
<div class="ad-slot ad-slot-banner" data-slot-type="banner" data-slot-kvps="pos=banner"></div></div></div></div>
<!-- end Banner ad -->
</div>
<div id="content" class="container">
<div id="fb-root"></div><!--[if lte IE 7]><link rel="stylesheet" charset="utf-8" media="screen" href="http://a.espncdn.com/combiner/c?css=modules/browser-alert.r7.css" type="text/css" /><div class="span-6" id="browser-alert-wrapper" style="display:none;"><div class="mod-container mod-no-header-footer browser-alert"><div class="mod-content"><div class="gradient-container"><h1><span>Your Web Browser</span> is no longer supported</h1><p>To experience everything that ESPN.com has to offer, we recommend that you upgrade to a newer version of your web browser. Click the upgrade button to the right or <a href="http://www.espn.com/espn/news/story/_/id/5630562">learn more</a>.</p><ul><li><a class="btn-upgrade" href="http://www.microsoft.com/windows/internet-explorer/default.aspx">Upgrade</a></li><li><a class="btn-faq" href="http://www.espn.com/espn/news/story/_/id/5630562">FAQs</a></li></ul></div></div></div></div><script>(function(b){setTimeout(function(){var a=b("#browser-alert-wrapper");if(espn.cookie.get("browseralert")!="true"){b('<a class="btn-close" href="#">Close</a>').bind("click",function(){a.hide();espn.cookie.set("browseralert","true",30);return false}).appendTo(a.find(".gradient-container"));a.show();espn.cookie.set("browseralert","true")}},100)})(jQuery);</script><![endif]-->

<link charset="utf-8" media="screen" type="text/css" href="http://a.espncdn.com/nba/tradeMachine/tradeMachine.css" rel="stylesheet">
<!--[if IE]><link charset="utf-8" media="screen" type="text/css" href="http://a.espncdn.com/nba/tradeMachine/tradeMachine_ie.css" rel="stylesheet"><![endif]-->
<!--[if lte IE 6]><link charset="utf-8" media="screen" type="text/css" href="http://a.espncdn.com/nba/tradeMachine/tradeMachine_ie6.css" rel="stylesheet"><![endif]-->
	<script type="text/javascript" src="http://a.espncdn.com/nba/tradeMachine/jquery.disable.text.select.pack.js" language="Javascript"></script>
	<script type="text/javascript">

	$j = jQuery.noConflict();

	var numTeams = 0;
	var activeEditTeam = -1;
	var tm_userName;
	var selectedPlayerId;
	var closePopupInterval;
	var closeTEInterval;

	$j(document).ready( function() {

		$j.getScript('http://espn.go.com/espn/js/unilogin?cb=setUserInfo')

		//team choices
		$j("#container-teams li").each( function() {
			var teamId = getTeamId($j(this));

			$j(this).find("a").click( function(event) {
				var isDisabled = $j(this).parent().parent().hasClass("disabled");

				if (!isDisabled) {
					if (activeEditTeam == -1) {
						addTeam(teamId);
					} else {
						replaceTeam(activeEditTeam, teamId);
					}
				}
				return false;
			});
		});

		$j("#container-top .team-btn-container a").bind('click', toggleAddTeam);

		$j("#action-popup").hover(
			function() {
				clearInterval(closePopupInterval);
			},
			function() {
				clearInterval(closePopupInterval);
				closePopup();
			}
		);

		$j("#exception-popup").hover(
			function() {
				clearInterval(closeTEInterval);
			},
			function() {
				clearInterval(closeTEInterval);
				closeTE();
			}
		);
	});

	function closePopup() {
		$j("#action-popup").hide();
	}

	function highlightPlayer(obj, toggle) {
		if (toggle) {
			$j(obj).addClass('active');
		} else {
			$j(obj).removeClass('active');
		}
	}

	//trade buttons
	function toggleTrade(active) {
		if (active) {
			$j(".btn-trade").replaceWith('<a class="btn-trade trade-on">Try This Trade</a>');
			$j(".btn-trade").click( function() {
				processTrade(true);
			});
		} else {
			$j(".btn-trade").replaceWith('<span class="btn-trade trade-off">Try This Trade</span>');
			$j(".btn-trade").unbind('click');
		}
	}

	function toggleAddTeam() {
		var isHidden = ($j("#container-teams").css("display") == 'none');
		var showTeams = isHidden;

		$j("#container-top .team-btn-container a").removeClass("active");

		if (numTeams < 4) {
			$j("#container-top .team-btn-container a:last").addClass("active");
		}

		if (!isHidden && activeEditTeam != -1) showTeams = true;
		toggleTeamContainer(showTeams);

		activeEditTeam = -1;
	}

	function toggleEditTeam(teamId, topBtn) {
		var isHidden = ($j("#container-teams").css("display") == 'none');
		var showTeams = isHidden;

		$j("#container-top .team-btn-container a").removeClass("active");

		if (isHidden || activeEditTeam != teamId) {
			$j(topBtn).addClass("active");
		}
		if (!isHidden && activeEditTeam != teamId) {
			showTeams = true;
		}

		toggleTeamContainer(showTeams);

		activeEditTeam = teamId;
	}

	function toggleTeamContainer(toggle) {
		if (toggle) {
			$j("#container-teams").show();
		} else {
			$j("#container-teams").hide();
		}
	}

	function toggleSelectTeam(teamId, activate) {

		var ddItem = $j("#container-teams .teamdd_"+teamId);
		if (activate) {
			ddItem.removeClass("disabled");
		} else {
			ddItem.addClass("disabled");
		}
	}

	function removeTrades(teamId) {
		//return all players traded to this team
		$j("#team_"+teamId+" .trades .player").each( function() {
			var fromTeamId = getTeamId($j(this));
			var tradeId = getPlayerId($j(this));
			removeTrade(tradeId, fromTeamId);
		});

		//remove all players traded from this team
		$j(".team-container .trades .player").filter(".team_"+teamId).each( function() {
			var tradeId = getPlayerId($j(this));
			removeTrade(tradeId, teamId);
		});
	}

	function removeTeam(teamId) {

		
			var confirmMsg = "Removing this team will release all players traded from this team and return all players traded to this team. Are you sure you want to continue?"
		

		var doRemove = confirm(confirmMsg);

		if (doRemove) {

			//find where the team is positioned
			var teamPos = getTeamPos("#team_"+teamId);

			//adjust add team links
			var aIndex = 1;

			$j("#container-top .team-btn-container").each( function() {

				if (aIndex > teamPos) {
					var anchor = $j(this).find("a");
					var label = $j(this).find("span");
					anchor.removeClass("addTeam"+(aIndex)).addClass("addTeam"+(aIndex-1))
					if (anchor.text().indexOf("Add Team") > -1) {
						anchor.html("Add Team "+(aIndex-1)+ " <img class=\"arrow\" src=\"http://a.espncdn.com/nba/tradeMachine//images/btn-downArrow.gif\" />");
					}

					label.text("Team "+(aIndex-1)+":");


				} else if (aIndex == teamPos) {
					$j(this).remove();
				}
				aIndex++;
			});

			removeTrades(teamId);

			//remove team container
			var teamContainer = $j("#team_"+teamId);
			var teamFullName = teamContainer.find(".teamName").text();
			teamContainer.remove();

			numTeams--;

			if (numTeams == 2) {
				var tradeBox = $j(".team-container .trades");
				tradeBox.find(".tradeAmount").show();
				tradeBox.find(".tradeAmount_sm").hide();
				tradeBox.each( function() {
					updatePlayerCount($j(this), 0);
				});

				var players = $j(".team-container .player, .team-container .exception");
				players.find(".salary").show();
				players.find(".salary_sm").hide();
			}

			if (numTeams == 3) {
				makeAddTeamLink(4);
			}

			refreshTeamContainers();
			toggleSelectTeam(teamId, true);

			removeTeamFromPopup(teamId);

			if (numTeams == 0) {
				$j("#instructions").show();
				$j("#second_instructions").hide();
			} else if (numTeams == 1) {
				$j("#second_instructions").show();
			}
		}
	}

	function makeAddTeamLink(linkNum) {
		var link = $j('<a class="active addTeam'+(linkNum)+'">Add Team '+(linkNum)+ ' <img class="arrow" src="http://a.espncdn.com/nba/tradeMachine//images/btn-downArrow.gif" /></a>')
			.bind('click', toggleAddTeam);

		var linkContainer = $j('<div class="team-btn-container"><span class="label">Team '+linkNum+':</span> </div>').append(link);

		$j("#container-top .team-btn-container a").removeClass("active");
		$j("#container-top .clear").before(linkContainer);
	}

	function refreshTeamContainers() {
		$j(".team-container").each( function() {
			$j(this)
				.removeClass("teams1")
				.removeClass("teams2")
				.removeClass("teams3")
				.removeClass("teams4")
				.addClass("teams"+numTeams);
		});
	}

	function addTeam(teamId) {
		if (numTeams == 0) {
			$j("#instructions").hide();
			$j("#second_instructions").show();
		} else if (numTeams == 1) {
			$j("#second_instructions").hide();
		}

		if (numTeams < 4) {
			showTeam(teamId, "");
			toggleSelectTeam(teamId, false);
		}


	}

	function replaceTeam(oldTeamId, newTeamId) {

		
			var confirmMsg = "Replacing a team will release all players traded from the replaced team and return all players traded to this team. Are you sure you want to continue?"
		

		var doReplace = confirm(confirmMsg);

		if (doReplace) {
			removeTrades(oldTeamId);
			removeTeamFromPopup(oldTeamId);
			$j("#container-top .team-btn-container a").removeClass("active");
			showTeam(newTeamId, "#team_"+oldTeamId);
			toggleSelectTeam(oldTeamId, true);
			toggleSelectTeam(newTeamId, false);

			if (numTeams < 4) {
				$j("#container-top .team-btn-container a:last").addClass("active");
			}
		}
	}

	function getTeamPos(target) {
		var teamPos = 0;

		if (target == "") {
			teamPos = numTeams;
		} else {
			$j(".team-container").each( function() {
				teamPos++;
				if ($j(this).is(target)) {
					return false;
				}

			});
		}

		return teamPos;
	}

	function showTeam(teamId, target) {

		$j("#container-teams .loading").show();
		var teamPos = (target == "") ? (numTeams+1):getTeamPos(target);
		var numTrades = getMaxTrades();

		$j.get("/nba/trademachine09/json/getTeamHTML" , {'teamId':teamId, 'teamPos':teamPos, 'numTeams':numTeams, 'numTrades':numTrades, 'langType':0}, function(teamHTML) {

			if (target == "") { numTeams++; }

			var teamContainer = $j(teamHTML);
			var teamFullName = teamContainer.find(".teamName").html();

			//remove text selection within the body
			//dragging isnt interfered with
			teamContainer.disableTextSelect();

			if (target != "" && $j(target).length == 1) {
				teamContainer.replaceAll(target);
			} else {
				teamContainer.insertBefore($j("#second_instructions"))

			}

			teamContainer
				.find(".closeBtn")
				.click( function() { removeTeam(teamId); });

			makePlayersDraggable(teamId);

			refreshTeamContainers();

			$j("#container-top .addTeam"+teamPos)
				.unbind('click')
				.click(function(event) {
					toggleEditTeam(teamId, event.target);
					return true;
				})
				.html(teamFullName+' <img class="arrow" src="http://a.espncdn.com/nba/tradeMachine/images/btn-downArrow.gif" />');
			if (target == "") {
				if (numTeams == 3) {
					tradeBox = $j(".team-container .trades");
					tradeBox.find(".tradeAmount").hide();
					tradeBox.find(".tradeAmount_sm").show();
					tradeBox.each( function() {
						updatePlayerCount($j(this), 0);
					});

					players = $j(".team-container .player, .team-container .exception");
					players.find(".salary").hide();
					players.find(".salary_sm").show();
				}

				if (numTeams < 4) {
					makeAddTeamLink(numTeams+1);
				} else {
					$j(".addTeam4").removeClass("active");
				}
			}

			$j("#container-teams .loading").hide();
			$j("#container-teams").hide();

			addTeamToPopup(teamId, teamFullName);

		});


	}

	function setDisabledPopupTeam(teamId) {
		$j("#action-popup ul li")
			.removeClass("disabled")
			.filter(".team_"+teamId)
			.addClass("disabled");
	}

	function removeTeamFromPopup(teamId) {
		$j("#action-popup ul li.team_"+teamId).remove();
	}

	function clearTeamsFromPopup() {
		$j("#action-popup ul li").remove();
	}

	function addTeamToPopup(teamId, teamName) {
		var li = $j('<li class="team_'+teamId+'"></li>');
		var anchor = $j('<a>'+teamName+'</a>')

		anchor.click( function() {
			var teamId = $j(this).parent().attr("class").split("_")[1];
			var playerId = selectedPlayerId;
			var origTeamId = getTeamId($j("#player_"+playerId));
			var fromTeamId = getPlayerFromTeam(playerId);
			var alreadyTraded = (origTeamId != fromTeamId);
			$j("#action-popup").hide();
			tradePlayer(playerId, fromTeamId, teamId, alreadyTraded, false);
		});
		$j("#action-popup ul").append(li.append(anchor));

	}

	function getPlayerFromTeam(playerId) {
		var teamId = getTeamId($j("#player_"+playerId));

		//cycle through all trades and try to find if the player is
		//currently being traded
		$j(".team-container").each( function() {
			var curTeamId = $j(this).attr("id").split("_")[1];
			$j(this).find(".trades .player").each( function() {
				var curId = getPlayerId($j(this));
				if (curId == playerId) {
					teamId = curTeamId;
					return false;
				}
			});
		});

		return teamId;
	}
/*
	function getDraggableSettings(teamId) {
		return {
			'revert':true,
			'revertDuration':1,
			'drag': function(event, ui) {
				selectedPlayerId = null;
				$j("#action-popup").hide();
			},
			'start': function(event, ui) {
				$j(".team-container").not("#team_"+teamId).each( function() {
					$j(this).find(".roster").hide();
					$j(this).find(".drop-area").show();
				});
			},
			'stop': function(event, ui) {
				//reposition div (for IE)
				$j(this).css("left", "0px").css("top", "0px");

				$j(".team-container").each( function() {
					$j(this).find(".drop-area").hide();
					$j(this).find(".roster").show();
				});
			}
		};
	}
*/

	function addException(playerId, tradeTeamId, exceptionId, amount) {
		$j("#exception-popup").hide();

		var eContainer = $j("#exception_"+exceptionId);
		if (eContainer.length > 0) {
			var amountLeft = currencyToInteger(eContainer.find(".salary").html());
			amountLeft -= amount;
			eContainer.find(".salary").html(integerToCurrency(amountLeft, false));
			eContainer.find(".salary_sm").html(integerToCurrency(amountLeft, true));
		}

		var eAsset;
		if (eContainer.length > 0) {
			eAsset = eContainer.clone();
	 	} else {
			eAsset = $j(".exception:first").clone();
	 	}
		eAsset.addClass(eAsset.attr("id"));
		eAsset.attr("id", "");
		eAsset.addClass("exception_for_"+playerId);
		eAsset.find(".salary").html(integerToCurrency(amount, false));
		eAsset.find(".salary_sm").html(integerToCurrency(amount, true));
		eAsset.find(".playerName").html("Trade Exception for");
		eAsset.find(".btn-closePlayer a").click( function() {
			removeException(playerId, tradeTeamId, exceptionId, amount);
		}).parent().show();

		var tradeBox = $j("#team_"+tradeTeamId+" .trades");
		var holderBoxes = tradeBox.find(".player-holder");
		var beforeElement = (holderBoxes.length > 0) ? ".player-holder:first":".trade_footer";

		tradeBox.find(beforeElement).before(eAsset);
		updateTradeAmount(tradeBox);

		var maxTrades = getMaxTrades();
		refreshTrades(maxTrades);

		//mark the player that is using the trade exception
		var tradePlayer = $j(".trades .player_"+playerId);
		tradePlayer.find(".teUsed").html("1");

		refreshExceptionBtns();
	}

	function removeException(playerId, tradeTeamId, exceptionId, amount) {

		var eContainer = $j("#exception_"+exceptionId);
		if (eContainer.length > 0) {
			var amountLeft = currencyToInteger(eContainer.find(".salary").html());
			amountLeft += amount;
			eContainer.find(".salary").html(integerToCurrency(amountLeft, false));
			eContainer.find(".salary_sm").html(integerToCurrency(amountLeft, true));
		}

		var eAsset = $j(".trades .exception_for_"+playerId);
		eAsset.remove();

		var tradeBox = $j("#team_"+tradeTeamId+" .trades");
		updateTradeAmount(tradeBox);

		var maxTrades = getMaxTrades();
		refreshTrades(maxTrades);

		//unmark the player that is using the trade exception
		var tradePlayer = $j(".trades .player_"+playerId);
		tradePlayer.find(".teUsed").html("0");

		refreshExceptionBtns();
	}

	function showExceptionList(e, tradePlayerId, tradeTeamId, exceptionTeamId) {
		var eList = $j("#exception_list");
		eList.children().remove();
		var eTeamName = "";
		var eAmount = $j("#player_"+tradePlayerId+" .salary").html();
		var eInteger = currencyToInteger(eAmount);

		$j("#team_"+exceptionTeamId+" .exceptions .exception").each( function() {
			var ePlayerName = $j(this).find(".playerName").text();
			var eId = $j(this).attr("id").split("_")[1];
			var eMax = currencyToInteger($j(this).find(".salary").text());
			var eValue = eInteger;

			if (eValue <= eMax + 100000) {
				if (eValue > eMax) {
					eValue = eMax;
				}
				eList.append('<li><a href="#" onclick="addException('+tradePlayerId+', '+tradeTeamId+', '+eId+', '+eValue+'); return false;">Use '+integerToCurrency(eValue, false)+' available from '+ePlayerName+'</a></li>');
			}
		});

		var containerOffset = $j(".span-6").offset();
		var isDeportes = (0 == 1) ? true:false;

		var relX = e.pageX;
		var relY = e.pageY;

		if (!isDeportes) {
			relX -= containerOffset.left;
			relY -= containerOffset.top + 90;
		}

		$j("#exception-popup")
			.css("left", (relX)+"px")
			.css("top", (relY)+"px")
			.show();

		closeTEInterval = setTimeout(closeTE, 3000);
	}

	function closeTE() {
		$j("#exception-popup").hide();
	}

	function openURL(link) {
		window.open(link, 'player_stats', '');
	}

	function makePlayersDraggable(teamId) {
		$j("#team_"+teamId+" .roster .player").not(".disabled").each( function() {
			var playerId = $j(this).attr("id").split("_")[1];

			$j(this)
			.click( function(e) {
				if ($j(e.target).hasClass("playerName") || $j(e.target).hasClass("player_mug")) {
					//open player stats page
					openURL("/nba/players/profile?playerId="+playerId);
				} else if (numTeams > 1) {

					alreadyTraded = ($j("#player_"+playerId+" .traded").css("display") != "none")

					if (!alreadyTraded) {
						if (numTeams == 2) {
							var fromTeamId = teamId;
							var toTeamId;
							$j(".team-container").each( function() {
								var thisId = $j(this).attr("id").split("_")[1];
								if (thisId != fromTeamId) {
									toTeamId = thisId;
								}
							});

							toggleRestriction(null, playerId, false, '');
							toggleRestriction(null, playerId, false, 'ppp');
							toggleRestriction(null, playerId, false, 'byc');

							tradePlayer(playerId, fromTeamId, toTeamId, false, false);

						} else {
							clearInterval(closePopupInterval);

							selectedPlayerId = playerId;
							var containerOffset = $j(".span-6").offset();

							var isDeportes = (0 == 1) ? true:false;

							var relX = e.pageX;
							var relY = e.pageY;

							if (!isDeportes && containerOffset != undefined) {
								relX -= containerOffset.left;
								relY -= containerOffset.top + 90;
							}

							setDisabledPopupTeam(teamId);

							$j("#action-popup")
								.css("left", (relX)+"px")
								.css("top", (relY)+"px")
								.show();

							closePopupInterval = setTimeout(closePopup, 3000);
						}
					}
				}
			});
		});

		/*
		$j("#team_"+teamId+" .drop-area").droppable(
			{
				'accept': ".player",
				'drop': function(event, ui) {

					var playerObj = $j(ui.draggable);
					var alreadyTraded = (playerObj.attr("id") == "")

					if (alreadyTraded) {
						playerId = getPlayerId(playerObj);
					} else {
						playerId = playerObj.attr("id").replace("player_", "");
					}

					var fromTeamObj = $j(playerObj.parents(".team-container").get(0));
					if (fromTeamObj.length > 0) {
						fromTeamId = fromTeamObj.attr("id").split("_")[1];
					} else {
						fromTeamId = getTeamId(playerObj);
					}

					var toTeamId = teamId;

					tradePlayer(playerId, fromTeamId, toTeamId, alreadyTraded, false);
				}
			}
		);
		*/
	}

	function addTradeExceptionBtn(playerObj, exceptionTeamId) {
		var isAvail = false;
		var playerSalary = currencyToInteger($j(playerObj).find(".salary").html());
		var tradePlayerId = getPlayerId(playerObj);
		var tradeTeamId = getTeamId(playerObj);

		$j("#team_"+exceptionTeamId+" .exception").each( function() {
			var eAmount = currencyToInteger($j(this).find(".salary").html());
			if (playerSalary < eAmount) {
				isAvail = true;
				return true;
			}
		});

		if (isAvail) {
			var teBtn = $j('<a href="#" class="teLink" onclick="return false;"><img src="http://a.espncdn.com/nba/tradeMachine/images/icon-te.gif" /></a>');
			teBtn.click( function(e) {
				showExceptionList(e, tradePlayerId, tradeTeamId, exceptionTeamId);
				return false;
			});
			$j(playerObj).find(".teUsed").after(teBtn);
		}
	}

	function refreshExceptionBtns() {
		$j(".team-container").each( function() {
			var teMax = 0;
			var teamId = $j(this).attr("id").split("_")[1];

			$j(this).find(".exceptions .exception").each( function() {
				var amt = currencyToInteger($j(this).find(".salary").html());
				if (amt > teMax) {
					teMax = amt;
				}
			});

			$j(this).find(".trades .player").each( function() {
				var salary = currencyToInteger($j(this).find(".salary").html());
				var teLink = $j(this).find(".teLink");
				var playerId = getPlayerId($j(this));

				var exceptionExists = ($j(".exception_for_"+playerId).length > 0);

				if (teLink.length > 0) {

					if (exceptionExists || salary > teMax) {
						teLink.remove();
					}
				} else if (!exceptionExists && salary < teMax) {
					addTradeExceptionBtn($j(this), teamId);
				}
			});
		});

	}

	function tradePlayer(playerId, fromTeamId, toTeamId, alreadyTraded, teUsed) {

		var playerTeamId = getTeamId($j("#player_"+playerId));
		var playerObj = $j("#player_"+playerId);
		if (teUsed == undefined) { teUsed = false; }

		if (playerTeamId == toTeamId) {
			return false;

		} else {

			var tPlayer = playerObj.clone().css("left", "0px").css("top", "0px");

			tPlayer.addClass(tPlayer.attr("id"));
			tPlayer.attr("id", "");

			tPlayer.find(".btn-closePlayer").show();
			tPlayer.find(".traded").hide();

			tPlayer.find(".playerName, .player_mug").click( function() {
				openURL("/nba/players/profile?playerId="+playerId);
			});

			var tradeBox = $j("#team_"+toTeamId+" .trades");

			var holderBoxes = tradeBox.find(".player-holder");
			var exceptions = tradeBox.find(".exception");
			var beforeElement = (holderBoxes.length > 0) ? ".player-holder:first":".trade_footer";
			
			beforeElement = (exceptions.length > 0) ? ".exception:first":beforeElement;
			
			// lets try to put these in order
			var items = tradeBox.find('.player');
			var tSalary = currencyToInteger(tPlayer.find('.salary').text());
			$j.each(items, function (i, v) {
				var item = $j(v),
					salary = currencyToInteger(item.find('.salary').text());
					//console.log(salary, tSalary);
				if (salary < tSalary) {
					beforeElement = item;
					return false;
				}
			});			

			tradeBox.find(beforeElement).before(tPlayer);
			refreshPlayerBoxes();

			var maxTrades = getMaxTrades();

			refreshTrades(maxTrades);

			//check if trade exception is available
			if (teUsed) {
				var amount = currencyToInteger(tPlayer.find(".salary").html());
				var exceptionId = fromTeamId+playerId;
				addException(playerId, fromTeamId, exceptionId, amount);
			} else {
				addTradeExceptionBtn(tPlayer, toTeamId);
			}

			//update traded to status
			var toTeamName = $j("#team_"+toTeamId+" .teamName").text();
			playerObj.find(".traded").show().find(".toTeam").text(toTeamName);

			updatePlayerCount(tradeBox);
			updateTradeAmount(tradeBox);

			$j(".team-container .trades").show();

			var fromRoster = $j(playerObj.parents(".roster").get(0));
			fromRoster.hide().show();
		}

		return true;
	}

	function updatePlayerCount(tradeBox) {
		var playerCountBox = tradeBox.find(".player-desc-c1 .numPlayers");
		var playerCount = tradeBox.find(".player").length

		wordage = "Player";

		if (playerCount != 1) { wordage += "s"; }

		playerCountBox.text(playerCount+" "+wordage);
	}

	function updateTradeAmount(tradeBox, process) {
		var tradeAmount = 0;
		tradeBox.find(".player").each( function() {
			tradeAmount += currencyToInteger($j(this).find(".salary").text());
		});	

		var amountStr = integerToCurrency(tradeAmount, false);
		var amountStr_sm = integerToCurrency(tradeAmount, true);

		tradeBox.find(".tradeAmount").html(amountStr);
		tradeBox.find(".tradeAmount_sm").html(amountStr_sm);
	}

	function getTeamId(obj) {
		var teamId = "";

		classes = $j(obj).attr("class").split(" ");

		for(i=0; i<classes.length; i++) {
			var parts = classes[i].split("_");
			if (parts.length == 2 && parts[0].indexOf("team") >= 0) {
				teamId = parts[1];
				break;
			}
		}

		return teamId;
	}

	function getPlayerId(obj) {
			var playerId = "";

			var classes = $j(obj).attr("class").split(" ");

			for(i=0; i<classes.length; i++) {
				var parts = classes[i].split("_");
				if (parts.length == 2 && parts[0].indexOf("player") >= 0) {
					playerId = parts[1];
					break;
				}
			}

			return playerId;
	}

	function toggleRestriction(btnObj, playerId, toggle, type) {

		if (type == undefined) { type == "" }
		var popup = $j('#restriction_'+type+playerId);

		if (toggle) {
			var popupContainer = popup.parent()
				.remove()
				.css("z-index", 4);

			$j($j(btnObj).parents(".player").get(0)).after(popupContainer);
			popup.show();
		} else {
			popup.hide();
		}

		return false;
	}

	function removeTrade(playerId, teamId) {

		var tradeBox = $j($j(".player_"+playerId).parents(".trades").get(0));

		//remove from trade container
		tradeBox.find(".player_"+playerId).remove();

		//check to see if any trade exceptions need to be removed
		$j(".trades .exception_for_"+playerId).each( function() {
			var eClasses = $j(this).attr("class").split(" ");
			var eId = 0;
			for(c=0;c<eClasses.length; c++) {
				var s = eClasses[c].split("_");
				if (s.length > 1 && s[0] == "exception") {
					eId = s[1];
					break;
				}
			}
			var eAmount = currencyToInteger($j(this).find(".salary").html());
			removeException(playerId, teamId, eId, eAmount);
		});

		//restore dragability of player from roster
		$j("#player_"+playerId)
			.find(".traded").hide()
			//.draggable("enable")
			;

		updatePlayerCount(tradeBox);
		updateTradeAmount(tradeBox);

		var maxTrades = getMaxTrades();

		refreshTrades(maxTrades);

		$j(".team-container .roster").hide().show();
	}

	function getMaxTrades() {
		var max=0;

		$j(".team-container .trades").each( function() {
			var numTrades = $j(this).find(".player").length;
			var numExceptions = $j(this).find(".exception:visible").length;
			if ((numTrades+numExceptions) > max) {max = (numTrades+numExceptions);}
		});

		return max;
	}

	function refreshTrades(numPlayers) {

		if (numPlayers == 0) {
			toggleTrade(false);
		} else if (numPlayers == 1) {
			toggleTrade(true);
		}

		$j(".team-container .trades").each( function() {
			var numTradeSlots = $j(this).find(".player, .exception:visible, .player-holder").length;

			if (numPlayers <= 0) {
				$j(this).find(".player-holder").remove();
				$j(this).hide();

			} else if (numTradeSlots < numPlayers) {
				tFooter = $j(this).find(".trade_footer");
				for(p=0; p<numPlayers-numTradeSlots; p++) {
					tFooter.before('<div class="player-holder"></div>');
				}
			} else if (numTradeSlots > numPlayers) {
				for(p=0; p<numTradeSlots-numPlayers; p++) {
					$j(this).find(".player-holder:last").remove();
				}
			}
		});
	}

	function refreshPlayerBoxes() {
		if ($j.browser.msie) {
			$j(".team-container .roster").hide();
			$j(".team-container .roster").show();
		}
	}

	function clearPrevTrade() {
		$j("#container-message .trade-message")
			.removeClass("success")
			.removeClass("fail")
			.text("");
		$j("#container-message").hide();

		$j("#container-message .fail-reasons").remove();

		$j("#container-message .trade-results").remove();

		$j(".btn-trade").hide();
	}

	function getTradeJSONString(minimal) {
		var jsonStr = '{"teams": [';

				teamCount = 0;
				$j(".team-container").each( function() {
					if (teamCount != 0) { jsonStr += ","; }
					jsonStr += '{';
					toTeamId = $j(this).attr("id").split("_")[1];

					jsonStr += '"inComingAssets": [';
					tradeCount = 0;
					$j(this).find(".trades .player").each( function() {
						if (tradeCount != 0) { jsonStr += ","; }
						jsonStr += '{'; 
						jsonStr += '"fromTeamId":"'+getTeamId($j(this))+'",';
						jsonStr += '"type":"player",';
						jsonStr += '"assetObj": {';
						jsonStr += '"teUsed": "'+false+'",';
						jsonStr += '"posId": '+$j(this).find(".posId").text()+',';
						if (!minimal) {
							jsonStr += '"name":"'+''+'",';
							jsonStr += '"salary":'+'0'+',';
						}
						jsonStr += '"playerId": "'+getPlayerId($j(this))+'"';
						jsonStr += '}';
						jsonStr += '}';
						tradeCount++;
					});
					jsonStr += '], '
					jsonStr += '"teamId":"'+toTeamId+'"';
					jsonStr += '}';

					teamCount++;
				});

				jsonStr += '],';
				jsonStr += '"userName":"'+tm_userName+'"';
		jsonStr += '}';
		
		//console.log(jsonStr);

		return jsonStr
	}

	function processTrade(isOriginal) {

		clearPrevTrade();

		var jsonStr = getTradeJSONString(false);

		$j.post("/nba/trademachine09/json/processTrade", {'tradeStr':jsonStr, 'isValid':isOriginal, 'langType':0}, function(result) {

			//console.log(result);

			trackResult(isOriginal);

			var navOptions;

			if (isOriginal) {
				navOptions = [
					'<a class="btn-trade-options fLeft" href="/nba/tradeMachine">Start Over</a>',
					'<a class="btn-trade-options fLeft" href="#" onclick="adjustTrade(); return false;">Adjust Trade</a>',
					'<a class="btn-trade-options fLeft" href="#" onclick="saveTrade(); return false;">Save Trade</a>',
					'<div class="clear"></div>'
				].join("\n");
			} else {
				navOptions = [
					'<a class="btn-trade-options" href="/nba/tradeMachine" style="margin:0 auto;">New Trade</a>',
					'<div style="clear:both;"></div>'
				].join("\n");
			}

			$j("#container-message")
				.show()
				.find(".nav-trade-options")
				.html(navOptions);


			if (result.success) {
				scoreClass = (result.score > 0) ? "green":"red";
				$j("#trade-main-message")
					.addClass("success")
					.text("This Trade is Successful!");

				if (result.tradeTeams != undefined) {
					showTradeResults(result.tradeTeams, isOriginal);
				}
			} else {

				if (result.reasons != undefined) {
					$j(".team-container").each( function() {
						teamId = $j(this).attr("id").split("_")[1];

						var teamReasons = result.reasons[teamId];
						var failList = "";

						if (teamReasons != undefined) {
							for(i=0; i<teamReasons.length; i++) {
								failList += "<li>"+teamReasons[i]+"</li>";
							}

							if (failList != "") $j(this).append('<ul class="fail-reasons">'+failList+'</ul>');
						}
					});
				}

				$j("#trade-main-message")
					.addClass("fail")
					.text("This Trade Failed")

			}

			$j("#projection_note").show();

			//hide trade buttons
			$j(".btn-trade").hide();
			$j(".team-btn-container").hide();

			//hide close buttons on teams and traded players
			$j(".team-container .team .closeBtn").hide();
			$j(".team-container .trades .player .btn-closePlayer").hide();
			$j(".team-container .trades .exception .btn-closePlayer").hide();
			$j(".team-container .trades .player .teLink").hide();
			// nick silva doesn't want to show these anymore
			$j(".team-container .trades .exception").hide();
			
			var maxTrades = getMaxTrades();
			refreshTrades(maxTrades);
			
			$j(".team-container .trades").each(function() {
				updateTradeAmount($j(this), true);
			});
			
			
			//hide rosters
			$j(".team-container .roster").hide();
			$j(".team-container .roster_header").hide();
			$j(".team-container .exceptions").hide();

			//deactivate draggability of traded players
			//$j(".team-container .trades .player").draggable("disable");

			if ($j("#container-body").css("display") == "none") {
				$j("#container-loading").hide();
				$j("#container-body").show();
				$j("#container-top .teambtns").show();
			}
		}, 'json');
	}

	function showTradeResults(tradeTeams, uniqueTrade) {

		var totalGames = 82;
		var likeSum = 0;
		var useProjections = false;

		var numTradeTeams = tradeTeams.length;
		for(t=0; t<numTradeTeams; t++) {

			var diff = tradeTeams[t].postWins - tradeTeams[t].preWins;
			var effect = (diff > 0) ? "increased":"decreased";
			var postRecord = tradeTeams[t].postWins+'-'+(totalGames-tradeTeams[t].postWins);
			var colorClass = (diff > 0) ? "green":"red";

			/*
			//team score
			var tsHTML  = '<div class="fLeft team-score">';
			tsHTML  += '<p class="result-header">Team Score:</p>';
			tsHTML  += '<p class="score"><span class="'+colorClass+'">'+tradeTeams[t].teamScore+'</span></p>';
			tsHTML  += '</div>';
			*/

			//projection
			var diffText = (diff > 0) ? "+"+diff:diff;

			var projHTML = '<div class="proj-record">';
			projHTML += '<p class="result-header">';
			projHTML += 'Hollinger\'s Analysis: ';
			if (useProjections) {
				projHTML += postRecord;
				if (diff != 0) projHTML += ' (<span class="'+colorClass+'">'+diffText+'&nbsp;Wins</span>)';
			} else {
				if (diff != 0) projHTML += '<span class="'+colorClass+'">'+diffText+'&nbsp;Wins</span>';
			}
			projHTML += '</p>';

			projHTML += '<p class="expl">';
			projHTML += (diff != 0) ?
									'With this trade you have '+effect+" "+"this team's projected wins by "+Math.abs(diff)+'.':
									'You have not affected the winning percentage of this team.';
			projHTML += '</p>';

			projHTML += '</div>';
			projHTML += '<div class="clear"></div>';

			/*
			var highHTML = "";
			if (uniqueTrade && tradeTeams[t].highScore) {
				ordinalNum = tradeTeams[t].rank.toOrdinal();
				highHTML += '<div class="high-score">';
				highHTML += '  <strong>Team High Score!</strong><br />';
				highHTML += '  <div class="fLeft star"><img src="http://a.espncdn.com/nba/tradeMachine/images/star.png" style="vertical-align:middle;" /><strong>'+ordinalNum+'</strong></div>';
				highHTML += '  <p>Your trade currently ranks <strong>'+ordinalNum+'</strong> for all '+tradeTeams[t].fullName+' trades.</p>';
				highHTML += '  <div style="clear:both;"></div>';
				highHTML += '</div>';
			}
			*/

			var resultHTML = '<div class="trade-results">' + projHTML + '</div>';

			$j("#team_"+tradeTeams[t].teamId).append(resultHTML);

		}
	}

	function adjustTrade() {
		//show close buttons
		$j(".team-container .team .closeBtn").show();
		$j(".team-container .trades .player .btn-closePlayer").show();
		$j(".team-container .trades .exception .btn-closePlayer").show();
		$j(".team-container .trades .player .teLink").show();
		$j(".team-container .trades .exception").each(function() {
			var $this = $j(this);
			$this.parent().find('.player-holder').eq(0).remove();
			$this.show();
		});
		$j(".team-container .trades").each(function() {
				updateTradeAmount($j(this));
			});

		//re-add draggability to trade players
		$j(".team-container .trades .player").each( function() {

			var teamId = getTeamId($j(this));
			//$j(this).draggable("enable");
		});

		//show rosters
		$j(".team-container .roster").show();
		$j(".team-container .exceptions").show();
		$j(".team-container .roster_header").show();
		$j(".team-container .trade-results").remove();

		//clear status and hide message
		$j("#trade-main-message")
			.removeClass("success")
			.removeClass("fail")
			.text("");

		$j("#container-message .trade-actions").hide();

		$j("#container-message").hide();

		$j("#projection_note").hide();

		$j(".team-container .fail-reasons").remove();

		//show trade buttons
		toggleTrade(true);
		$j(".btn-trade").show();
		$j(".team-btn-container").show()
		$j("#container-url").hide();
	}

	function startOver() {
		//remove team links
		$j("#container-top .team-btn-container").remove();
		makeAddTeamLink(1);
		$j("#container-teams .teamName").removeClass("disabled");

		//remove teams
		numTeams = 0;
		$j(".team-container").remove();
		clearTeamsFromPopup();

		//clear status and hide message
		$j("#trade-main-message")
			.removeClass("success")
			.removeClass("fail")
			.text("");

		$j("#container-message").hide();

		$j("#container-message .fail-reasons").remove();

		//show trade buttons
		toggleTrade(false);
		$j(".btn-trade").hide();
		$j(".team-btn-container").show();
		$j("#container-url").hide();
	}

	function saveTrade() {

		var baseURL = "http://www.espn.com/nba/tradeMachine";
		if ("www.espn.com" == "null") {
			baseURL = "http://games.espn.go.com/nba/tradeMachine"
		}
		var jsonStr = getTradeJSONString(true);

		$j.getJSON("/nba/trademachine09/json/getTradeURL", {'baseURL':baseURL, 'tradeStr':jsonStr}, function(result) {
			if (result.tradeURL != undefined && result.tradeURL != "null" && result.tradeURL != "") {
				$j("#tradeURL").attr("href", result.tradeURL).html(result.tradeURL);
				$j("#container-message .trade-actions").show();
			}
		});
	}

	function loadTrade(tradeStr) {
		$j("#container-body").hide();
		$j("#container-loading").show();

		$j("#container-top .teambtns").hide();
		
		//stripping out anything that comes after the last bracket in the json obj
		lastBracket = tradeStr.lastIndexOf('}');
		tradeStr = tradeStr.substring(0,lastBracket+1);

		$j.getJSON("/nba/trademachine09/json/toJSON", {'jsonStr':tradeStr}, function(result) {
			
			var jsonObj = result;
			var teamQueue = new Array();

			if (result.teams != undefined) {

				if (result.teams.length >= 3 && $j.browser.msie && parseFloat($j.browser.version) <= 6.0) {
					// known multi team js issue
					// stop loading and showing warning message

					$j("#container-body").append(
						'<p style="margin:20px 30px 20px 20px; padding:10px; color:#fff; background-color:#B52432;">There is a known issue when loading previously saved trade involving 3 or more teams using Internet Explorer 6.0. We are unable to load the trade requested due to this error. If possible, you can either <a href="http://www.microsoft.com/windows/downloads/ie/getitnow.mspx" style="font-weight:bold; color:#fff;">upgrade your browser</a> or try using another browser such as <a href="http://www.mozilla.com/firefox/" style="font-weight:bold; color:#fff;">Firefox</a>. Thank you for your understanding as we work on a resolution to this problem.</p>'
					);
					toggleTrade(false);
					$j("#container-loading").hide();
					$j("#container-body").show();
					$j("#container-top .teambtns").hide();
				} else {
					var lastTeamId = "";
					//add teams

					for(t=0; t<result.teams.length; t++) {

						var teamId = result.teams[t]["teamId"];

						if(t == 0) {
							addTeam(teamId);
						} else {
							lastTeamId = result.teams[t-1]["teamId"];
							teamQueue.push(teamId);

							$j.onAvailable("team_"+lastTeamId, function() {
								var nextTeamId = teamQueue.shift();

								addTeam(nextTeamId);

								if (teamQueue.length == 0) {
									$j.onAvailable("team_"+nextTeamId, function() {
										loadTradePlayers(result);
									});
								}
							});
						}
					}
				}
			}
		});
	}

	function loadTradePlayers(result) {
		//check to see if at least one player was successfully moved to the other team
		var tradeSuccess = false;

		//process trades
		for(t=0; t<result.teams.length; t++) {
			var toTeamId = result.teams[t]["teamId"];
			var assets = result.teams[t]["inComingAssets"];

			if (assets != undefined) {
				for(a=0; a<assets.length; a++) {
					var fromTeamId = assets[a]["fromTeamId"];
					var tradePlayerId = assets[a]["assetObj"]["playerId"];
					var teUsed = assets[a]["assetObj"]["teUsed"] || false;
					var playerSuccess = tradePlayer(tradePlayerId, fromTeamId, toTeamId, false, teUsed);
					tradeSuccess = (playerSuccess || tradeSuccess);
				}

				$j(".player .teLink").hide();
			}
		}

		if (tradeSuccess) {
			//execute trade
			processTrade(false);
		} else {
			//none of the players are on their saved teams anymore
			//so we are assuming this trade actually happened
			showTrade(result);
		}
	}


	function showTrade(result) {
		//instead of trading each player,
		//put them in the trade block of the team they are already on
		var tradeSuccess = false;

		for(t=0; t<result.teams.length; t++) {
			var toTeamId = result.teams[t]["teamId"];
			var assets = result.teams[t]["inComingAssets"];

			if (assets != undefined) {
				for(a=0; a<assets.length; a++) {
					var fromTeamId = assets[a]["fromTeamId"];
					var tradePlayerId = assets[a]["assetObj"]["playerId"];
					var teUsed = assets[a]["assetObj"]["teUsed"] || false;
					tradeSuccess = showTradedPlayer(tradePlayerId, toTeamId, fromTeamId, teUsed) || tradeSuccess;
				}
			}
		}

		navOptions = [
			'<a class="btn-trade-options" href="/nba/tradeMachine" style="margin:0 auto;">New Trade</a>',
			'<div style="clear:both;"></div>'
		].join("\n");

		$j("#container-message")
			.show()
			.find(".nav-trade-options")
			.html(navOptions);

		$j("#trade-main-message")
			.addClass("success")
			.text("This Trade is Successful!");

		$j("#container-loading").hide();
		toggleTrade(false);
		$j(".roster, .roster_header, .exceptions, .btn-closePlayer, .trades .player .teLink").hide();
		$j("#container-body").show();
	}

	function showTradedPlayer(playerId, newTeamId, oldTeamId, teUsed) {
		var playerTeamId = getTeamId($j("#player_"+playerId));
		var playerObj = $j("#player_"+playerId);
		if (teUsed == undefined) { teUsed = false; }

		if (newTeamId == playerTeamId) {

			var tPlayer = playerObj.clone().css("left", "0px").css("top", "0px");

			tPlayer.addClass(tPlayer.attr("id"));
			tPlayer.attr("id", "");

			tPlayer.find(".btn-closePlayer").show();
			tPlayer.find(".traded").hide();


			var tradeBox = $j("#team_"+newTeamId+" .trades");

			var holderBoxes = tradeBox.find(".player-holder");
			var beforeElement = (holderBoxes.length > 0) ? ".player-holder:first":".trade_footer";

			tradeBox.find(beforeElement).before(tPlayer);
			refreshPlayerBoxes();

			var maxTrades = getMaxTrades();

			refreshTrades(maxTrades);

			//check if trade exception is available
			if (teUsed) {
				var amount = currencyToInteger(tPlayer.find(".salary").html());
				var exceptionId = oldTeamId+playerId;
				addException(playerId, oldTeamId, exceptionId, amount);
			}


			updatePlayerCount(tradeBox);
			updateTradeAmount(tradeBox);

			$j(".team-container .trades").show();
		}
	}

	function abbreviateName(firstName, lastName) {
		abbrevName = "";

		firstNames = firstName.split(" ");
		for (n=0; n<firstNames.length; n++) {
			abbrevName += firstNames[n].substring(0, 1)+".";
		}
		abbrevName += " "+lastName;
		return abbrevName;
	}

	function currencyToInteger(curString) {
		curString = curString.replace(eval("/\\$|,/ig"), "");
		if (curString == "" || curString == "&nbsp;") return 0;
		else if (curString[curString.length-1] == "M") {
			curInt = parseInt(curString.substr(0, curString.length-1));
			return curInt*1000000;
		} else if (curString[curString.length-1] == "K") {
			curInt = parseInt(curString.substr(0, curString.length-1));
			return curInt*1000;
		}

		return parseInt(curString);
	}

	function integerToCurrency(amount, toSmall) {

		if (amount == 0 || amount == "") return "&nbsp;";

		var resultStr = "";
		var sign = (amount < 0) ? "-":"";
		amount = Math.abs(amount);

		if (toSmall) {
			//abbreviate
			if (amount > 1000000) {
				amount = Math.round(amount/100000)/10;
				resultStr = amount+"M";
			} else if (amount > 1000) {
				amount = Math.round(amount/100)/10;
				resultStr = amount+"K";
			}
		} else {
			//add commas
			var amountChars = (amount+"").split("");

			for(n=0; n<amountChars.length; n++) {
				c = amountChars.length-n-1;
				if (n%3 == 0 && n != 0 && !(c == 0 && amountChars[0] == "-")) {
					resultStr = ","+resultStr;
				}
				resultStr = amountChars[c] + resultStr;
			}
		}

		return sign+"$"+resultStr;
	}

	Number.prototype.toOrdinal = function() {
		var n = this % 100;
		var suff = ["th", "st", "nd", "rd", "th"]; // suff for suffix
		var ord= n<21?(n<4 ? suff[n]:suff[0]): (n%10>4 ? suff[0] : suff[n%10]);
		return this + ord;
	}

	function setUserInfo(userName,firstName,activelyLoggedIn){
		tm_userName = userName;
	}

	function trackResult(isOriginal) {

		var trackCode = "nba:trademachine";
		trackCode += (isOriginal) ? "result":"view";
		anClearVars();

		try {
			s_omni.pageName=trackCode;
			s_omni.server = window.location.host;
			s_omni.channel = "nba";
			s_omni.prop1 = "espn";
			s_omni.prop5 = "nba:trademachine";
			s_omni.prop17 = "en";
			s_omni.prop25 = "basketball";
			s_omni.prop26 = "nba";
			s_omni.prop30 = "n";
			s_omni.hier1 = "nba";
			s_omni.eVar9 = "en";
			s_omni.eVar13 = trackCode;
			s_omni.eVar19 = "basketball";
			s_omni.eVar21 = "nba";

			var s_code=s_omni.t();if(s_code)document.write(s_code)

		} catch (e) {}

	}


	</script>
	<script language="javascript" type="text/javascript" charset="windows-1252" src="http://a.espncdn.com/nba/tradeMachine//oo_engine.js"></script>

	<!-- Container -->
	<div class="span-6">
		<div class="container-tm">

			<!-- Top Container -->
			<div id="container-top">
				<div class="fRight">
					
						<a href="javascript:O_LC();" class="feedback_btn"><img src="http://a.espncdn.com/nba/tradeMachine//images/opinion.gif" border="0" title="Feedback" style="margin-right:5px;">Feedback</a>
					
					<a href="/nba/tradeMachine" style="color:#fff; padding:0 10px;">Start Over</a>

				</div>
				<div class="header"><a href="/nba/tradeMachine">
				<img src="http://a.espncdn.com/nba/tradeMachine/images/header-main.png" />
				</a></div>
				<div class="teambtns">
					<div class="team-btn-container"><span class="label">Team 1:</span> <a class="active addTeam1">Add Team 1 <img class="arrow" src="http://a.espncdn.com/nba/tradeMachine//images/btn-downArrow.gif" /></a></div>
					<div class="clear"></div>
				</div>
			</div>
			<div id="container-teams">
				<div class="top"></div>
				<div style="position:relative;">
					<div class="loading">
						<img src="http://a.espncdn.com/nba/tradeMachine/images/loader.gif" /><br />
						<p>Loading Team Information</p>
					</div>
				</div>
				<div class="body">
					<div>
						<a href="#" class="fRight closeBtn" onclick="toggleTeamContainer(false); return false;">Close <img class="btn" src="http://a.espncdn.com/nba/tradeMachine/images/btn-closePlayer.gif" /></a>
						<div style="clear:both;"></div>
					</div>
					<div class="conference"><h3>Eastern Conference</h3><ul><li class="teamName teamdd_1"><div class="logo-nba-small nba-small-atl"><a>Atlanta</a></div></li><li class="teamName teamdd_2"><div class="logo-nba-small nba-small-bos"><a>Boston</a></div></li><li class="teamName teamdd_17"><div class="logo-nba-small nba-small-bkn"><a>Brooklyn</a></div></li><li class="teamName teamdd_30"><div class="logo-nba-small nba-small-cha"><a>Charlotte</a></div></li><li class="teamName teamdd_4"><div class="logo-nba-small nba-small-chi"><a>Chicago</a></div></li><li class="teamName teamdd_5"><div class="logo-nba-small nba-small-cle"><a>Cleveland</a></div></li><li class="teamName teamdd_8"><div class="logo-nba-small nba-small-det"><a>Detroit</a></div></li><li class="teamName teamdd_11"><div class="logo-nba-small nba-small-ind"><a>Indiana</a></div></li></ul><ul><li class="teamName teamdd_14"><div class="logo-nba-small nba-small-mia"><a>Miami</a></div></li><li class="teamName teamdd_15"><div class="logo-nba-small nba-small-mil"><a>Milwaukee</a></div></li><li class="teamName teamdd_18"><div class="logo-nba-small nba-small-nyk"><a>New York</a></div></li><li class="teamName teamdd_19"><div class="logo-nba-small nba-small-orl"><a>Orlando</a></div></li><li class="teamName teamdd_20"><div class="logo-nba-small nba-small-phi"><a>Philadelphia</a></div></li><li class="teamName teamdd_28"><div class="logo-nba-small nba-small-tor"><a>Toronto</a></div></li><li class="teamName teamdd_27"><div class="logo-nba-small nba-small-was"><a>Washington</a></div></li></ul><div style="clear:both;"></div></div><div class="conference"><h3>Western Conference</h3><ul><li class="teamName teamdd_6"><div class="logo-nba-small nba-small-dal"><a>Dallas</a></div></li><li class="teamName teamdd_7"><div class="logo-nba-small nba-small-den"><a>Denver</a></div></li><li class="teamName teamdd_9"><div class="logo-nba-small nba-small-gsw"><a>Golden State</a></div></li><li class="teamName teamdd_10"><div class="logo-nba-small nba-small-hou"><a>Houston</a></div></li><li class="teamName teamdd_12"><div class="logo-nba-small nba-small-lac"><a>LA</a></div></li><li class="teamName teamdd_13"><div class="logo-nba-small nba-small-lal"><a>LA Lakers</a></div></li><li class="teamName teamdd_29"><div class="logo-nba-small nba-small-mem"><a>Memphis</a></div></li><li class="teamName teamdd_16"><div class="logo-nba-small nba-small-min"><a>Minnesota</a></div></li></ul><ul><li class="teamName teamdd_3"><div class="logo-nba-small nba-small-nor"><a>New Orleans</a></div></li><li class="teamName teamdd_25"><div class="logo-nba-small nba-small-okc"><a>Oklahoma City</a></div></li><li class="teamName teamdd_21"><div class="logo-nba-small nba-small-pho"><a>Phoenix</a></div></li><li class="teamName teamdd_22"><div class="logo-nba-small nba-small-por"><a>Portland</a></div></li><li class="teamName teamdd_23"><div class="logo-nba-small nba-small-sac"><a>Sacramento</a></div></li><li class="teamName teamdd_24"><div class="logo-nba-small nba-small-sas"><a>San Antonio</a></div></li><li class="teamName teamdd_26"><div class="logo-nba-small nba-small-uth"><a>Utah</a></div></li></ul><div style="clear:both;"></div></div>
					</ul>
					<div style="clear:both;"></div>
				</div>
				<div class="bottom"></div>
			</div>
			<!-- End of Top Container -->

			<!-- Body Container -->
			<div id="container-body">
				<div id="container-message">
					<div id="trade-main-message" class="trade-message"></div>
					<div class="nav-trade-options"></div>
					<div class="trade-actions">
						<h3>Share your trade</h3>
						<p class="savedTrade">
							<a id="tradeURL" style="color:#D6CFD6; text-decoration: underline;" href=""></a>
							<a id="conversationURL" href="http://myespn.go.com/s/conversations/show/story/3894776" target="_blank" style="margin-left:10px; color:#fff; text-decoration:underline;">Post trade to ESPN</a>
						</p>
					</div>
				</div>

				<span class="btn-trade trade-off">Try This Trade</span>
				<div id="action-popup">
					<h3>Trade to:</h3>
					<ul id="trade_to_list">
					</ul>
				</div>

				<div id="exception-popup">
					<h3>Trade Exceptions:</h3>
					<ul id="exception_list">
					</ul>
				</div>

				<div id="second_instructions">
					<h3 style="color:#777;">Add a Second Team</h3>
				</div>
				<div id="team-clear" class="clear"></div>
				<div id="projection_note">
				<strong>Projected Record Note:</strong><br />Projected records are based on the PER of the players in each teams post-trade rotation. Taking into account the players traded and the ability of their replacements, it is possible for each team in a trade to have a better projected record, or for each team to have a worse one, or for one team to be better and another to be worse by a different number of games.
				</div>
				
<div id="instructions">
	<h2>HOW TO USE THE TRADE MACHINE</h2>
	<div class="step">
		<span class="num num1"><img src="http://a.espncdn.com/nba/tradeMachine/images/icon_1.gif" /></span>
		<h3>Add a team</h3>
		<p>Click on the "Add Team 1" button to add a team to trade. You need two teams to start a trade.</p>
		<div class="clear"></div>
	</div>

	<div class="step">
		<span class="num num2"><img src="http://a.espncdn.com/nba/tradeMachine/images/icon_2.gif" /></span>
		<h3>Add a second team</h3>
		<p>Click on the "Add Team 2" button to add a second team.</p>
		<div class="clear"></div>
	</div>

	<div class="step">
		<span class="num num3"><img src="http://a.espncdn.com/nba/tradeMachine/images/icon_3.gif" /></span>
		<h3>Trade players</h3>
		<p>Simply click on a player to trade him to another team. If there are 3 or more teams involved select the team you want to trade to from the drop down after clicking on a player.</p>
		<div class="clear"></div>
	</div>

	<div class="step">
		<span class="num num4"><img src="http://a.espncdn.com/nba/tradeMachine/images/icon_4.gif" /></span>
		<h3>Try your trade</h3>
		<p>The ESPN.com NBA Trade Machine will let you know if your trade works based on the NBA's trade rules!</p>
		<div class="clear"></div>
	</div>

	<div class="step">
		<span class="num num5"><img src="http://a.espncdn.com/nba/tradeMachine/images/icon_5.gif" /></span>
		<h3>Share your trade</h3>
		<p>Discuss your trade with others on the <a href="http://myespn.go.com/s/conversations/show/story/3894776" style="color:#EDD7B1; font-weight:bold;" target="_blank">Trade Machine Conversation</a> page by posting the link provided after trying a trade.</p>
		<div class="clear"></div>
	</div>
</div>

				<div class="last-clear" style="clear:both;"></div>
			</div>
			<!-- End of Body Container -->

			<div id="container-loading">
				<img src="http://a.espncdn.com/nba/tradeMachine//images/loader.gif" style="margin-bottom:5px;"/><br />
				LOADING TRADE...
			</div>
			<div id="container-bottom">
				<div style="clear:both;"></div>
				<span class="btn-trade trade-off">Try This Trade</span>
			</div>

		</div>
	</div></div>
<script type="text/javascript">

				// load new edition settings
				var espn = espn || {};
				espn.i18n = espn.i18n || {};
				espn.i18n.lang = "en";
				espn.i18n.siteId = "1";
				espn.i18n.site = "espn";
				espn.i18n.editionKey = "espn-en";
				espn.i18n.personalization = true;
				espn.i18n.country = "us";
				espn.i18n.countryName = "null";
				espn.i18n.domain = "www.espn.com";
				espn.i18n.searchUrl = "http://search.espn.com/";
				espn.i18n.hasSearch = true;
				espn.i18n.defaultSearchParams = {};
				espn.i18n.nowFeed = true;
				espn.i18n.temperature = {scale: "fahrenheit", symbol: "&deg; F" };
				espn.i18n.facebook = {appId: "116656161708917", locale: "en_US" };
				espn.i18n.twitter = {language: "en"};
				espn.i18n.outbrain = {"mobile":{"compliantId":"MB_4","nonCompliantId":"MB_5"},"desktop":{"compliantId":"AR_15","nonCompliantId":"AR_12"},"video":{"mobile":{"compliantId":"MB_6"},"desktop":{"compliantId":"AR_16"}},"recap":{"mobile":{"compliantId":"MB_9"},"desktop":{"compliantId":"AR_30"}}}
				espn.i18n.betting = {show: true, provider: "", bet365blacklist: ["ww", "us", "pk", "in", "eg", "ir", "sa", "sy", "ae", "il", "jo", "ps", "lb", "om", "kw", "qa", "bh", "ye", "lk", "fr", "fx", "au"]};
				espn.i18n.tickets = {"enabled":true,"provider":"VividSeats","baseUrl":"https://www.vividseats.com","callToAction":"Buy on Vivid Seats","trackSection":"vivid"};
				espn.i18n.translations = {};
				espn.i18n.environment = "prod";
				espn.i18n.sportBranding = {"soccer":"logos/logo-uk-fc.png","wnba":"logos/ESPNcom-powerby-espnw.png","womenbb":"logos/ESPNcom-powerby-espnw.png","ncw":"logos/ESPNcom-powerby-espnw.png","cricket":"logos/logo-uk-cricinfo.png","rugby":"logos/logo-uk-scrum.png","ncaaw":"logos/ESPNcom-powerby-espnw.png"};
				espn.i18n.sportToUrl = {"soccer":"http://www.espnfc.us","wnba":"http://espnw.com","womenbb":"http://espnw.com","ncw":"http://espnw.com","cricket":"http://www.espncricinfo.com","ncaaw":"http://espnw.com"};
				espn.i18n.showWatch = true;
				
				espn.i18n.showFCContent = false;
				espn.i18n.showCricInfoContent = false;
				espn.i18n.showInsider = true;
				espn.i18n.indexAutoStart = false;
				espn.i18n.videoAutoStart = {index: false, scoreboard: false };
				espn.i18n.customPrimaryNav = false;
				espn.i18n.isSingleSport = false;
				espn.i18n.sportReplacements = "null";
				espn.i18n.localePrependedPath = false;

				espn.i18n.uriRewrites = {"paramValues":{"toEnglish":{},"toEdition":{}},"urls":{"toEdition":{},"toEnglish":{}},"paramKeys":{"toEnglish":{},"toEdition":{}},"roots":{"toEdition":{"/horse/":"/horse-racing/","/nascar/":"/racing/nascar/","/ncaa/":"/college-sports/","/ncb/":"/mens-college-basketball/","/ncf/":"/college-football/","/oly/":"/olympics/","/rpm/":"/racing/","/womenbb/":"/womens-basketball/","/flb/":"/fantasy/baseball/","/fba/":"/fantasy/basketball/","/ffl/":"/fantasy/football/","/fhl/":"/fantasy/hockey/","/recruitingfb/":"/college-sports/football/recruiting/","/recruitingbb/":"/college-sports/basketball/recruiting/","/espys/":"/espys/","/nba/summerleague/":"/nba-summer-league/"},"toEnglish":{"/oly/summer/gymnastics/":"/oly/summer/gymnastics/","/oly/summer/cycling/":"/oly/summer/cycling/","/racing/nascar/":"/nascar/","/racing/":"/rpm/","/college-football/":"/ncf/","/college-football/rumors":"/college-football/rumors","/mens-college-basketball/":"/ncb/","/mens-college-basketball/rumors":"/mens-college-basketball/rumors","/womens-college-basketball/":"/ncw/","/womens-basketball/":"/womenbb/","/olympics/":"/oly/","/cycling/":"/oly/","/figure-skating/":"/oly/","/college-sports/":"/ncaa/","/gymnastics/":"/oly/","/skiing/":"/oly/","/horse-racing/":"/horse/","/sports/womenbb/":"/womenbb/","/sports/horse/":"/horse/","/sports/endurance/":"/endurance/","/losangeles/":"/los-angeles/","/newyork/":"/new-york/","/espn/onenacion/":"/onenacion/","/fantasy/baseball/":"/flb/","/fantasy/basketball/":"/fba/","/fantasy/football/":"/ffl/","/fantasy/hockey/":"/fhl/","/college-sports/football/recruiting/":"/recruitingfb/","/college-sports/basketball/recruiting/":"/recruitingbb/","/nba-summer-league/":"/nba/summerleague/"}},"pathSegments":{"toEnglish":{},"toEdition":{}}};

				try {
					var translations = {"cancel":"Cancel","manageSettingInPersonalSettings":"You can manage this setting in the future under your <a href=\"#\">Personal Settings<\/a>","video.next.text":"Up Next","favoritesmgmt.manualSortSelected":"You have chosen to manually order how your favorites will appear across ESPN products. At any time, you may return to having ESPN order your favorites by selecting the \"Auto\" option.","preferences.sport_labels.8367":"Esports","preferences.sport_labels.2020":"NASCAR","draftcast.onTheClock":"On The Clock","Soccer Scores":"Football Scores","preferences.sport_labels.800":"Field Hockey","message.leaguemanager":"Message LM","draftcast.teamNews_%{teamName}":"Full ${teamName} Draft Coverage","favoritesmgmt.suggestedHeader":"Suggestions for your location","score":"Score","favorites.carousel.espnapp.link":"http://www.espn.com/espn/mobile/products/products/_/id/6857590","preferences.sport_labels.3918":"English FA Cup","driveChart.winper":"Win %","enter":"Enter","favoritesmgmt.confirmHideFavorite":"Hide this from my favorites?","links.event.game.desktop.href.cricket":"http://www.espncricinfo.com/${matchName}/engine/match/${competitionId}.html","draftcast.endOfDraft":"End of Draft","nflBye":"Bye","linescore.errors.short":"E","preferences.sport_labels.3520":"Poker","preferences.sport_labels.2030":"Formula 1","redesignWelcomeText":"We've redesigned the site with some new and exciting features. You have been selected as part of a limited set of fans who get to experience our new site and give it feedback before it launches!","videoSettings":"Video Settings","edit":"Edit","draftcast.previousPick":"Previous Pick","reactivate":"Reactivate","to_be_determined.abbrev":"TBD","favoriteadded":"Favorite Added","preferences.sport_labels.8374":"Kabaddi","signOut":"Log Out","preferences.sport_labels.8098":"X Games","preferences.sport_labels.8373":"Badminton","createAccount":"Sign Up","draftcast.bestAvailable":"Best Available","preferences.sport_labels.8372":"Chess","draftcast.emptyPositionTable":"No selections have been made for this position.","favoritesmgmt.favoriteEntity":"${entity} - Favorite","connectedfacebook":"Connected to Facebook","draftcast.roundNotStartedYet_%{round}":"Rd ${round} not started","preferences.sport_labels.1106":"Golf","draftcast.emptyTeamsTable_%{season}_%{league}_%{fullTeamName}":"The ${fullTeamName} have no picks for the ${season} ${league} draft.","linescore.runs.short":"R","onefeed.scheduleDraft":"Schedule Draft","insider.pickcenter.login_message":"To get exclusive PickCenter analysis, you must be an ESPN Insider","preferences.sport_labels.3920":"English Capital One Cup","favorites.streakLabel":"Streak:","favoritesmgmt.confirmRemoveFavorite":"Remove Favorite?","onefeed.draftNow":"Draft Now","preferences.sport_labels.781":"European Championship","preferences.sport_labels.2000":"Racing","preferences.sport_labels.300":"Rugby","facebook.conversation.account_policy":"Use a <a href=\"https://www.facebook.com/r.php\" rel=\"nofollow\">Facebook account<\/a> to add a comment, subject to Facebook's <a href=\"https://www.facebook.com/